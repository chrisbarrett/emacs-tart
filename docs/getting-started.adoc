= Getting Started with Tart
:toc: left
:toclevels: 2
:source-highlighter: rouge

== What is Tart?

Tart is a static type system for Emacs Lisp. Think TypeScript, but for Elisp.

You write `.tart` files that declare the types of your library's public functions
and variables. The type checker verifies your implementation matches these
declarations, and consumers who also use Tart get type checking for calls into
your library.

There's no runtime component--everything happens at development time via the
editor or CLI. Your Elisp code runs exactly as it always did.

== Installation

=== Building from Source

Tart is built with OCaml using Nix for reproducible builds.

[source,bash]
----
git clone https://github.com/chrisbarrett/emacs-tart.git
cd emacs-tart
nix develop
dune build
----

The `tart` executable is at `_build/default/bin/tart.exe`. You can run it
directly:

[source,bash]
----
dune exec tart -- --help
----

Or add the build directory to your PATH:

[source,bash]
----
export PATH="$PWD/_build/default/bin:$PATH"
tart --help
----

=== Emacs Package

Add the `lisp/` directory to your `load-path`:

[source,elisp]
----
(add-to-list 'load-path "/path/to/emacs-tart/lisp")
----

== Your First .tart File

Create a simple Elisp library. Let's make `greeter.el`:

[source,elisp]
----
;;; greeter.el --- A friendly greeter -*- lexical-binding: t -*-

(defun greeter-hello (name)
  "Return a greeting for NAME."
  (concat "Hello, " name "!"))

(defun greeter-farewell (name)
  "Return a farewell for NAME."
  (concat "Goodbye, " name "!"))

(provide 'greeter)
;;; greeter.el ends here
----

Now create `greeter.tart` in the same directory:

[source,elisp]
----
;; greeter.tart - Type declarations for greeter.el

(defun greeter-hello (string) -> string)
(defun greeter-farewell (string) -> string)
----

The `.tart` file declares that both functions take a string and return a string.

== Running the Type Checker

From the directory containing your files, run:

[source,bash]
----
tart greeter.el
----

If everything is correct, the command exits silently with code 0. If there's a
type error, you'll see a message like:

[source]
----
greeter.el:5:12: error: type mismatch
  expected: String
  found: Int
----

Let's introduce an error to see this in action. Change the implementation:

[source,elisp]
----
(defun greeter-hello (name)
  "Return a greeting for NAME."
  (+ 1 name))  ;; This won't type-check!
----

Run `tart greeter.el` again:

[source]
----
greeter.el:5:6: error: type mismatch
  expected: String
  found: Int
  note: function body doesn't match declared return type
    declared return type is String in greeter.tart
----

== Seeing Errors in Your Editor

Tart includes an LSP server for real-time feedback in your editor.

=== Emacs with Eglot

The `tart-mode` package provides Emacs integration. Add to your config:

[source,elisp]
----
(require 'tart-mode)
(add-hook 'emacs-lisp-mode-hook #'tart-eglot-ensure)
----

The `tart-eglot-ensure` function automatically starts the LSP server when you
edit an `.el` file that has a sibling `.tart` file.

You can also start eglot manually in any Elisp buffer:

[source]
----
M-x eglot
----

Once connected, you get:

* *Diagnostics* - Type errors appear as squiggly underlines
* *Hover* - Point at a function to see its type
* *Go to definition* - Jump to where a function is defined
* *Completion* - Type-aware suggestions as you type

=== Other Editors

Any editor with LSP support can use Tart. Start the server with:

[source,bash]
----
tart lsp
----

This runs on stdio by default. For TCP mode:

[source,bash]
----
tart lsp --port 9000
----

== The REPL

Tart includes an interactive REPL for exploring types:

[source,bash]
----
tart repl
----

[source]
----
tart 0.1.0 REPL
Type ,help for commands, ,quit to exit.

tart> (+ 1 2)
3 :: Int
tart> (concat "hello" " " "world")
"hello world" :: String
tart> ,type (mapcar (lambda (x) (+ x 1)) '(1 2 3))
(List Int)
tart> ,quit
----

REPL commands:

* `,type <expr>` - Show the type without evaluating
* `,expand <expr>` - Show macro expansion
* `,env` - List current bindings
* `,help` - Show available commands
* `,quit` - Exit the REPL

== Next Steps

You're now ready to start adding types to your Emacs Lisp code. Here's where to
go next:

* *link:library-authors.adoc[Library Authors Guide]* - Full guide to writing
  `.tart` files, including generics, union types, and module directives.

* *link:tooling-setup.adoc[Tooling Setup]* - Detailed editor configuration
  and REPL usage.

* *link:cli-reference.adoc[CLI Reference]* - Complete command-line documentation.

* *link:reference/tart-format.md[.tart Format Reference]* - Grammar and syntax
  reference for signature files.
